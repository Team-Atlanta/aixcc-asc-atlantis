CWE-940 involves the improper verification of the source of a communication channel, which is a significant security issue in software and hardware systems. This weakness occurs when a product sets up a communication channel in response to an incoming request from an actor but fails to correctly verify that the request is indeed coming from the anticipated source. This oversight allows attackers to establish communication channels from untrusted origins, potentially gaining unauthorized privileges and access to unintended functionality. The problem is abstract in nature, meaning it is mostly independent of specific resources or technologies, yet it provides enough detail for detection and prevention methods. Related weaknesses include Origin Validation Error (CWE-346) and Improper Restriction of Communication Channel to Intended Endpoints (CWE-923), with potential mitigations involving the use of mechanisms such as certificates to validate the identity of the source and the integrity of the data to prevent Adversary-in-the-Middle (AITM) attacks. This CWE also advises considering whether actions triggered by URL schemes in applications should be accessible to all mobile applications or restricted to a list of allowlisted applications. Common consequences of exploiting this weakness include gaining privileges or assuming identity, which varies depending on the context, and accessing functionality not intended for the source. Demonstrative examples include unprotected Android and iOS applications that do not check the origin of intents or URLs, allowing malicious entities to perform unauthorized actions or access sensitive information.