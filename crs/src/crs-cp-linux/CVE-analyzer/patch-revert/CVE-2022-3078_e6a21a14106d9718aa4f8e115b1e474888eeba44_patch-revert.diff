diff --git a/drivers/media/test-drivers/vidtv/vidtv_s302m.c b/drivers/media/test-drivers/vidtv/vidtv_s302m.c
index 4676083cee3b..d79b65854627 100644
--- a/drivers/media/test-drivers/vidtv/vidtv_s302m.c
+++ b/drivers/media/test-drivers/vidtv/vidtv_s302m.c
@@ -455,9 +455,6 @@ struct vidtv_encoder
 		e->name = kstrdup(args.name, GFP_KERNEL);
 
 	e->encoder_buf = vzalloc(VIDTV_S302M_BUF_SZ);
-	if (!e->encoder_buf)
-		goto out_kfree_e;
-
 	e->encoder_buf_sz = VIDTV_S302M_BUF_SZ;
 	e->encoder_buf_offset = 0;
 
@@ -470,8 +467,10 @@ struct vidtv_encoder
 	e->is_video_encoder = false;
 
 	ctx = kzalloc(priv_sz, GFP_KERNEL);
-	if (!ctx)
-		goto out_kfree_buf;
+	if (!ctx) {
+		kfree(e);
+		return NULL;
+	}
 
 	e->ctx = ctx;
 	ctx->last_duration = 0;
@@ -499,14 +498,6 @@ struct vidtv_encoder
 	e->next = NULL;
 
 	return e;
-
-out_kfree_buf:
-	kfree(e->encoder_buf);
-
-out_kfree_e:
-	kfree(e->name);
-	kfree(e);
-	return NULL;
 }
 
 void vidtv_s302m_encoder_destroy(struct vidtv_encoder *e)
