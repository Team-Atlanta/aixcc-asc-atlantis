diff --git a/drivers/virt/acrn/hsm.c b/drivers/virt/acrn/hsm.c
index 423ea888d79a..5419794fccf1 100644
--- a/drivers/virt/acrn/hsm.c
+++ b/drivers/virt/acrn/hsm.c
@@ -136,10 +136,8 @@ static long acrn_dev_ioctl(struct file *filp, unsigned int cmd,
 		if (IS_ERR(vm_param))
 			return PTR_ERR(vm_param);
 
-		if ((vm_param->reserved0 | vm_param->reserved1) != 0) {
-			kfree(vm_param);
+		if ((vm_param->reserved0 | vm_param->reserved1) != 0)
 			return -EINVAL;
-		}
 
 		vm = acrn_vm_create(vm, vm_param);
 		if (!vm) {
@@ -184,29 +182,21 @@ static long acrn_dev_ioctl(struct file *filp, unsigned int cmd,
 			return PTR_ERR(cpu_regs);
 
 		for (i = 0; i < ARRAY_SIZE(cpu_regs->reserved); i++)
-			if (cpu_regs->reserved[i]) {
-				kfree(cpu_regs);
+			if (cpu_regs->reserved[i])
 				return -EINVAL;
-			}
 
 		for (i = 0; i < ARRAY_SIZE(cpu_regs->vcpu_regs.reserved_32); i++)
-			if (cpu_regs->vcpu_regs.reserved_32[i]) {
-				kfree(cpu_regs);
+			if (cpu_regs->vcpu_regs.reserved_32[i])
 				return -EINVAL;
-			}
 
 		for (i = 0; i < ARRAY_SIZE(cpu_regs->vcpu_regs.reserved_64); i++)
-			if (cpu_regs->vcpu_regs.reserved_64[i]) {
-				kfree(cpu_regs);
+			if (cpu_regs->vcpu_regs.reserved_64[i])
 				return -EINVAL;
-			}
 
 		for (i = 0; i < ARRAY_SIZE(cpu_regs->vcpu_regs.gdt.reserved); i++)
 			if (cpu_regs->vcpu_regs.gdt.reserved[i] |
-			    cpu_regs->vcpu_regs.idt.reserved[i]) {
-				kfree(cpu_regs);
+			    cpu_regs->vcpu_regs.idt.reserved[i])
 				return -EINVAL;
-			}
 
 		ret = hcall_set_vcpu_regs(vm->vmid, virt_to_phys(cpu_regs));
 		if (ret < 0)
