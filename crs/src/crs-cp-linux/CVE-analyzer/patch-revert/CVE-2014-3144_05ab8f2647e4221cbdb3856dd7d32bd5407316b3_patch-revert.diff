diff --git a/net/core/filter.c b/net/core/filter.c
index 0e0856f5d708..e08b3822c72a 100644
--- a/net/core/filter.c
+++ b/net/core/filter.c
@@ -600,9 +600,6 @@ static u64 __skb_get_nlattr(u64 ctx, u64 A, u64 X, u64 r4, u64 r5)
 	if (skb_is_nonlinear(skb))
 		return 0;
 
-	if (skb->len < sizeof(struct nlattr))
-		return 0;
-
 	if (A > skb->len - sizeof(struct nlattr))
 		return 0;
 
@@ -621,14 +618,11 @@ static u64 __skb_get_nlattr_nest(u64 ctx, u64 A, u64 X, u64 r4, u64 r5)
 	if (skb_is_nonlinear(skb))
 		return 0;
 
-	if (skb->len < sizeof(struct nlattr))
-		return 0;
-
 	if (A > skb->len - sizeof(struct nlattr))
 		return 0;
 
 	nla = (struct nlattr *) &skb->data[A];
-	if (nla->nla_len > skb->len - A)
+	if (nla->nla_len > A - skb->len)
 		return 0;
 
 	nla = nla_find_nested(nla, X);
