diff --git a/net/ipv4/route.c b/net/ipv4/route.c
index a6f20ee35335..99c06944501a 100644
--- a/net/ipv4/route.c
+++ b/net/ipv4/route.c
@@ -600,14 +600,14 @@ static struct fib_nh_exception *fnhe_oldest(struct fnhe_hash_bucket *hash)
 	return oldest;
 }
 
-static u32 fnhe_hashfun(__be32 daddr)
+static inline u32 fnhe_hashfun(__be32 daddr)
 {
-	static siphash_key_t fnhe_hash_key __read_mostly;
-	u64 hval;
+	static u32 fnhe_hashrnd __read_mostly;
+	u32 hval;
 
-	net_get_random_once(&fnhe_hash_key, sizeof(fnhe_hash_key));
-	hval = siphash_1u32((__force u32)daddr, &fnhe_hash_key);
-	return hash_64(hval, FNHE_HASH_SHIFT);
+	net_get_random_once(&fnhe_hashrnd, sizeof(fnhe_hashrnd));
+	hval = jhash_1word((__force u32)daddr, fnhe_hashrnd);
+	return hash_32(hval, FNHE_HASH_SHIFT);
 }
 
 static void fill_route_from_fnhe(struct rtable *rt, struct fib_nh_exception *fnhe)
