diff --git a/drivers/crypto/ccp/ccp-ops.c b/drivers/crypto/ccp/ccp-ops.c
index 422193690fd4..c8da8eb160da 100644
--- a/drivers/crypto/ccp/ccp-ops.c
+++ b/drivers/crypto/ccp/ccp-ops.c
@@ -1777,9 +1777,8 @@ ccp_run_sha_cmd(struct ccp_cmd_queue *cmd_q, struct ccp_cmd *cmd)
 			       LSB_ITEM_SIZE);
 			break;
 		default:
-			kfree(hmac_buf);
 			ret = -EINVAL;
-			goto e_data;
+			goto e_ctx;
 		}
 
 		memset(&hmac_cmd, 0, sizeof(hmac_cmd));
