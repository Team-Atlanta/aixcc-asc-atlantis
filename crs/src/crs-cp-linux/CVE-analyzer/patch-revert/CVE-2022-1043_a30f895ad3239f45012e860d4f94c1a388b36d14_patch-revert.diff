diff --git a/fs/io_uring.c b/fs/io_uring.c
index a2e20a6fbfed..979941bcd15a 100644
--- a/fs/io_uring.c
+++ b/fs/io_uring.c
@@ -9843,11 +9843,10 @@ static int io_register_personality(struct io_ring_ctx *ctx)
 
 	ret = xa_alloc_cyclic(&ctx->personalities, &id, (void *)creds,
 			XA_LIMIT(0, USHRT_MAX), &ctx->pers_next, GFP_KERNEL);
-	if (ret < 0) {
-		put_cred(creds);
-		return ret;
-	}
-	return id;
+	if (!ret)
+		return id;
+	put_cred(creds);
+	return ret;
 }
 
 static int io_register_restrictions(struct io_ring_ctx *ctx, void __user *arg,
