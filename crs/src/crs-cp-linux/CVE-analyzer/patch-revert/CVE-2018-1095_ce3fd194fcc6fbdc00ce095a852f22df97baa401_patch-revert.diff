diff --git a/fs/ext4/xattr.c b/fs/ext4/xattr.c
index 2077d87b09f2..63656dbafdc4 100644
--- a/fs/ext4/xattr.c
+++ b/fs/ext4/xattr.c
@@ -195,13 +195,10 @@ ext4_xattr_check_entries(struct ext4_xattr_entry *entry, void *end,
 
 	/* Check the values */
 	while (!IS_LAST_ENTRY(entry)) {
-		u32 size = le32_to_cpu(entry->e_value_size);
-
-		if (size > INT_MAX)
-			return -EFSCORRUPTED;
-
-		if (size != 0 && entry->e_value_inum == 0) {
+		if (entry->e_value_size != 0 &&
+		    entry->e_value_inum == 0) {
 			u16 offs = le16_to_cpu(entry->e_value_offs);
+			u32 size = le32_to_cpu(entry->e_value_size);
 			void *value;
 
 			/*
